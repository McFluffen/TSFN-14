name: Deploy Event microservice

on:

  # Deploys the microservice on push to subfolder video-streaming on the main branch of this code repository.
  push:
    branches:
      - main
    paths:
      - './Event Microservice/**' # Only trigger on push to video-streaming subfolder.
  
  # Allows workflow to be invoked manually through the GitHub Actions user interface.
  workflow_dispatch:

jobs:
  eventmicroservice:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: 'Event Microservice' # Sets default path for "run" commands to the User-MicroService subfolder.
    
    # Sets environment variables with values extracted from GitHub Actions Repository Secrets.
    env:
      VERSION: ${{ github.sha }}
      CONTAINER_REGISTRY_LOGIN_SERVER: ${{ secrets.CONTAINER_REGISTRY_LOGIN_SERVER }}
      CONTAINER_REGISTRY_USERNAME: ${{ secrets.CONTAINER_REGISTRY_USERNAME }}
      CONTAINER_REGISTRY_PASSWORD: ${{ secrets.CONTAINER_REGISTRY_PASSWORD }}

    steps:

      # Checks-out repository under $GITHUB_WORKSPACE.
      - uses: actions/checkout@v4

      # Installs Node.js.
      - uses: actions/setup-node@v4
        with:
          node-version: 19.9.0
          cache: 'npm'
          cache-dependency-path: 'Event Microservice/package-lock.json' # Path to package-lock.json in video-streaming subfolder.
      

      # Builds the Docker image.
      - name: Build
        run: docker build -t edittime.azurecr.io/eventmicroservice:$VERSION --file ./Dockerfile .

      # Publishes the Docker image to the Azure Container Registry.
      - name: Publish
        run: |
          echo scLbo3UJ1Z0PXMYjzSHfyB7JVZIOjsj/Ppse0wa4Jy+ACRBNoSiz | docker login edittime.azurecr.io --username edittime --password-stdin
          docker push $CONTAINER_REGISTRY_LOGIN_SERVER/eventmicroservice:$VERSION

      # Installs Kubectl and connects it to the Azure Kubernetes Service (AKS) cluster.
      # https://github.com/marketplace/actions/kubernetes-cli-kubectl
      - uses: tale/kubectl-action@v1
        with:
          base64-kube-config: YXBpVmVyc2lvbjogdjENCmNsdXN0ZXJzOg0KLSBjbHVzdGVyOg0KICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VVMlZFTkRRWFJIWjBGM1NVSkJaMGxTUVVsWFJscG1Ra3BXYzJzdlJuRmFUbWxITW1sVEt6aDNSRkZaU2t0dldrbG9kbU5PUVZGRlRFSlJRWGNLUkZSRlRFMUJhMGRCTVZWRlFYaE5RMWt5UlhkSlFtTk9UV3BSZDAxcVJURk5ha2t3VFVSQk1sZG9aMUJOYWtFeFRrUkJlVTFVVlhsTmFsVjNUVVJhWVFwTlFUQjRRM3BCU2tKblRsWkNRVTFVUVcxT2FFMUpTVU5KYWtGT1FtZHJjV2hyYVVjNWR6QkNRVkZGUmtGQlQwTkJaemhCVFVsSlEwTm5TME5CWjBWQkNuRTJkbWhxVDFkRVNVWnJhbVphU0ZKYU9VcDBZelZ1Ulc1UlNqbHNVMnhMVjBnMk9FSldXREk0V0c1Rk5IVktlRTgxY1ZWMVRDODFObmM0YTJsUEsyVUtkQ3N2TVVkUFozaFlNVGt6VTJSSVJVaFdVM0ZOZWtoQk1VbHBiVTlYYVZKaGJHTnBSbkZTYjJ0c01uWTJNVmRuUTBwMlRYSlpabEJFVUVObmMwaFZOd3BGUTFvM1ZtNHZZV1JWUmpacVMwTjNia0ZpWnpoM1JqTk1aMk5LUzNGcFNVUnpabFJsV2xsNlFqZEZlVkZFV1U1VFZ5c3ZaVFZNUjFRMWFYaEtjR2hWQ2xOdVdraHVWVmhUUTBOdGNWcE5XVVYzWlU1WVZISlNlbU13VEhaSGVUaEpjVXR4VWtaT2N6WXJiWGsxZDB3MFUzZzNLMUppTlhJdk9UbEhMMVpMYVZBS1JscHdZVk4wZVhJclRsaDBVM1JqYVVaaVJDdExhM2Q1V1RCVlJYUlRSR1V2VWtaR1JGZzFaMjVHVEhoYWVIWTVRa3BKUm5kWmNHTktRV2cyUzNCdFNRcG9Va3d5ZG1WTE9XSldVbU42Ym5GS1Vua3lWV3RQUnpsTGRIVkRWUzkxYmpGeVFrMWtXalkyZDI5NWFWSkpTVWhzT1hnM1FUTnZXR3hhUWlzMWMweGhDa2d3VFVaRlNWbE1jVE5oTkVremJtdEJXa2xyYkN0RGMwOUJSRUZJUkZvNVZqaERXbGxCVTFwaVRYZDVTVGxTZVhaa1VUWnFZamhITkRGdFVrTTFZVWtLY1VkaWFtSXdiREkzT1hONlRtdDZjSFJqTW1ObkswaERNQ3RTWTNRMVRVSkxhR3QyYzJRNVRYUXpRVnBEYWsxT1UzaDJXV295V2xKbFEycFFNM0pNUndweFoyUkVja1J6ZDB0cFQxbEhaRkZ1VDJOUmEyYzVjWEJEWlVacVJDOUhjbVJCU1hwWGRtRXZNVzB3VlU1UU1FMXNSMkUwZVVGT1UyOTFVVmRHYUN0SUNrSm5iVFZ6UjBGMWNFNHlMMVV5Tml0SFEzRXZkekl2TjNKb1ZqQlNNRzUwU0ZONGVHdFhSbTh4Y0VaYVpFNTBPSGg0VFZaaGJXSTVVMDl3TDJwMGFqTUtPSEJxUzBaSFRIaFJkVVZ3YW1wVWJEbExhMlZ0VUc5SFlrdHlhbFoxTDFOUWVIVmtNa05QUzNsaU1FTkJkMFZCUVdGT1EwMUZRWGRFWjFsRVZsSXdVQXBCVVVndlFrRlJSRUZuUzJ0TlFUaEhRVEZWWkVWM1JVSXZkMUZHVFVGTlFrRm1PSGRJVVZsRVZsSXdUMEpDV1VWR1NVSkpTRFppWWpOcmNUZDNWbGxDQ2tkVWRVMTVhMnN3WlhrMFJFMUJNRWREVTNGSFUwbGlNMFJSUlVKRGQxVkJRVFJKUTBGUlFXRTNkbGN6Wmt0S1NtaHJTRU16YW5aSU1FNVZhbFZLTDNrS2MxRnRlWFZTVWtSa05VWmxVbWxRYmpGbE1tMDBWMk0yV0ZOSUswVlNNVXBDTmtRdmIweG1kMW96TjJsa09WVmtVSGhyUTNkWmJEbFZiMUpqYVVkeVp3cE1TM1E0ZFVsTVJtc3pVa3N3YlVsbmJqZGFWekpoUzJaVmNGYzVSa1pTYTJSM0t6WTBTR1l2VmxaaVduWk5ha1ZRTkZwaVRtbDBNMkk1VjFKcFJGTmhDa3RZSzJsWVNXZFZXV3hGYkZwUkwzVjNTVWRpUmpaWFQyWXhUVGcyUzNaSlZrVkJlVkJUZDJ0aE9FMUNTV1F6U0ZoblpYVm9VR2htZVUxWFZFZDFabXNLTDJkNFIySlFSVmRpYTA5aEx6QjVXRkZyZVdndk5TdHRVekl6VkU5bVNsUTVXbkJNVG1GWllYZFpWMVpNTDNwM1dHRm5USFZKYzFSVmRERTJVemRuYndwVFRra3hlbWxqWW1oT00xWm1abGhtT0dOTFRuVmhMMUZvV1Nzd1RsRkRla2RaZFU4eU1XaG1hRUZGVVc5WFpFMDRTblpQYzBOeVF6UlVOWEpzUlN0d0NtWTBhRTg1TUdWbU1rODFibmgwYlZoWU9EZFBlVWRwZWpnemNITnpWWE5IVVZaRkwyNVlibFEzVlRNeVNtTlBZMk52VG1kbVFXeDNSMjA1VFhZclJYY0tkMjV5TW01cVNqa3lhbEl2UkdrMlUzVTBkelp2ZFdWcE1sTklSM1JGVlRrMmJIbHVOMWhYT1RCNlRYTm1LMW95VEU0MGF6bHhPRVZoZEVwNE55dFVUQXBRVkRSNk9USmtTVVY1ZFRSSlNqSmlMMFZUZDNKVWJuQXhTR1pOVDFOWlYxSnRla05oYjFsRlIwOXlUMFZIWVhwSU1tVldXRlJGY1VKeVEzcEpZVk54Q25sMk0xRnZURU5xZFd0eVpIcG1OamxYWTBsMWNFRTJXV1JqUnpKRU5saFRiRGxJWjFwdloySlFSbVJVUTJsaVMyRklUU3RhZGxSamVETjJTamt3VG5vS1JsVlZkbVpCUlZVelJURlFNM1J1TTFOQ2RsQlVWa3BrWTFoQlIxaHNRMjlzYTNOWGJUVlRSRk5VVDI0d04yY3pURlEwWkVOblVrdzNaRE5uYUhCcVRRbzFjbG81VjJkdVNFTkhOVlJxWW1kVWRWRTlQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09DQogICAgc2VydmVyOiBodHRwczovL2VkaXR0aW1lLW55dGp0c2w5LmhjcC53ZXN0ZXVyb3BlLmF6bWs4cy5pbzo0NDMNCiAgbmFtZTogZWRpdHRpbWUNCmNvbnRleHRzOg0KLSBjb250ZXh0Og0KICAgIGNsdXN0ZXI6IGVkaXR0aW1lDQogICAgdXNlcjogY2x1c3RlclVzZXJfZWRpdHRpbWVfZWRpdHRpbWUNCiAgbmFtZTogZWRpdHRpbWUNCmN1cnJlbnQtY29udGV4dDogZWRpdHRpbWUNCmtpbmQ6IENvbmZpZw0KcHJlZmVyZW5jZXM6IHt9DQp1c2VyczoNCi0gbmFtZTogY2x1c3RlclVzZXJfZWRpdHRpbWVfZWRpdHRpbWUNCiAgdXNlcjoNCiAgICBjbGllbnQtY2VydGlmaWNhdGUtZGF0YTogTFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2sxSlNVWklWRU5EUVhkWFowRjNTVUpCWjBsUlkxTmpiSFZwWVM4MFZGSnFlRTF1VTBSbVlVUlFla0ZPUW1kcmNXaHJhVWM1ZHpCQ1FWRnpSa0ZFUVU0S1RWRnpkME5SV1VSV1VWRkVSWGRLYWxsVVFXVkdkekI1VGtSQmVVMVVWWGxOYWxGM1RVUmFZVVozTUhsT2FrRjVUVlJWZVUxcVZYZE5SRnBoVFVSQmVBcEdla0ZXUW1kT1ZrSkJiMVJFYms0MVl6TlNiR0pVY0hSWldFNHdXbGhLZWsxU1ZYZEZkMWxFVmxGUlJFVjNlSFJaV0U0d1dsaEthbUpIYkd4aWJsRjNDbWRuU1dsTlFUQkhRMU54UjFOSllqTkVVVVZDUVZGVlFVRTBTVU5FZDBGM1oyZEpTMEZ2U1VOQlVVUXpLMXBuU2xCemQzaFpXbXByT1daS1ExQnllVEVLTVVGR1lYRkpjMk5DYWs5VUswUTVORlExTDI1MWF6VTFNMVJXWmxsSVJsZFFVa2RRV0RSU2MyVTJTbkk1UlZsMlpsQTRSRlpHWWpsM1JXWjRPVzFKWWdveGExWjVRWHBoYjFjNVdVSnJSVGwyV1ZWeU9GaFJkVXNyVjFsTFduQTNWVUpDWldoUVExWnpWVGxXV0dGVlZVOXlPR2cyU21GWGFsVXZZVVpvUVRSSkNua3JSemt4UmpKTmVYTldUV2RWUm5sNFVUQmpibFJLUjBkTVUwRmtiV0o0V0VWbFMyMHdUR0ptZUhaTU5YcHFTSEpYT0dsSU5XZ3djR0pzTVN0bE56UUtjREZxYXpCakwzaFZPQ3R4VFRKNVFYUndURlJyV2t4dVdUaEdWbkZzTDNocGNHeE9WMlJHTmtVck5YRnBWMWNyUm5kdWQyVTRjbkpTWjNkUU9VUXdjZ3BTTkRSTFp6WnBTRWxEYzNGVlVXOU1ZV016VjB3MlpFSlBhRVpFY0ZCMWNTOVFWbXAyVWtwaFIyaHNUVzVhVFZWYVkwUnBiRGhMUkRoM2VYWlVVR1Y1Q2xGSVJuQjVabXhwVG5GUlowOXhaVWhJVkV0cmVIbGhXa2hDTDJkSVZGQlhWblZzT1dkNGNsVTFXblZOYldaaFdYVnlXRkZ1TDJSdFUwOHJhME5oVjJzS1pYbFZWeXRpVnpaS01sTTNjMUp5TlZCelYyNVBjREJXYlhkSVF6bEZSa3hFV2pCQlREWnRjRFpKZDFCMGIybE5abVowVW5GclZuSldNazAwVlhVdmFBcG9NbE53VDBSbWFteFVaME5NTlZsSlZtUjNOVkpMUVRVNFFrTXllbEp6VHpaNVFqaG5SSFJvUVhBNE1GZHhjM1JTYkc5NlFUWkJRa05hWWtKb09HVkVDbGhvUlRrMWRrWnRkMlZCVDJjdlptbE1WM3BKZFVvclpESm5hbEJMWldkQ2JFSk5kemhCUjJsUlZUZzRkMFpHZFZncmVsTnRlVE5HVEhOQ2VVUjVkVWtLUjNkaVpUVlNTMWxLY2toWlEwNXFPR2RLYjBwblowbGlhbVpuTHk5NmNEbFhjMDlCYlRkWWMwOTRlbUZyVUZsTGRscHNPVGg0WXk5eVMxRnhSVWhGTVFwTFpIVndNV1Z3VkZsT1kyZzFkSEozZVVreVVYQlJTVVJCVVVGQ2J6RlpkMVpFUVU5Q1owNVdTRkU0UWtGbU9FVkNRVTFEUW1GQmQwVjNXVVJXVWpCc0NrSkJkM2REWjFsSlMzZFpRa0pSVlVoQmQwbDNSRUZaUkZaU01GUkJVVWd2UWtGSmQwRkVRV1pDWjA1V1NGTk5SVWRFUVZkblFsTkJVMElyYlRJNU5Vc0tkVGhHVjBGU2F6ZHFUWEJLVGtoemRVRjZRVTVDWjJ0eGFHdHBSemwzTUVKQlVYTkdRVUZQUTBGblJVRnZhRk5OUjBSMGFtSnRjRFZGT0ZGc1pYSm1UZ3BEZUdJdmNGRTBVMlJ4UWtkRE9XRklTbHBZYmxkRFJsVlhNWEFyYlROcldXVjRhMVpWVXpocU4xWndRMGg1YldwQ1NYcHZjbXhIUmt0RmNFVkVTM2RIQ2tkeFFWRlpTRTFVZVRab1FYaFRNVU00V2tJeWMxQk5VaXMyWm5kMWExVmhiMHRpYjBvNFUwcFNOMFZ3YVRKdlJHOXJkbEEyTTBGWWFVbzFWM2R0T1RjS0szcEhSa05NY2xoNVltUTNibWR6SzJSbGJWWkNhRWRoUjJ4cFp6VTFiU3R6TVdsa2JWazNTWFppY0hNNE9XVnFhRTEwUlZGeGVGVk5RMEZKWlhoeFFncFhSelpEY1ZSNVVFOUpPRXhMYlVSUGR6VTFTMHd2UkZkT1JHSjVlbmgyYkROcWFsRTRjM1J6V0dSclYySTJWbUZDU1RjeVZtZFROVFl5ZVZaVVVUaGFDbUYzZDFsbFVHNUxjRmd2TnpKc1VHTXZaMjFqU1doUU9FVmhiVzlRUVVOQlpGbHVkbk5oTUUxQ1dUVjFOV0pEZEhKSGNuVkNibE5GYlZKMGVGTk1VQ3NLWW1KR1NVcExhRFpVYnpRelFUSjRVRE52YmtSSFdXMXpPRWRUVDFSUkswcDNWVkZCWTBZd1NGcE5VbmhUS3k5MmVFcDBjRTFRT0dnNVdYcDNSRlY0YkFwMmFrSXliakV2Umt0MlZrMUlRMVJ2VFROS09IaEdWRkE0VEdKcVdVVlVRa2d6Um01UEwwTlRWRTQwUzFsRU1raG5TbEJNUm5wTVJEVlJTV3B1VFZWWUNrRldRVEJsSzBkR2NFWnNXV1ZLYjI0NE9GWTNNREpZWW5GcU1VUkROMFJMVEdveWJGbGpZVkZLVFRsRGJGWTFUWEU0UVRRMlozbGlNbTVWTVVGaVozSUthbVJTZERoUVkxQjJaak15UTBVeGNqQk1VelpNWTBGa2FtOVhPV3hHUkV4Mk4zaFRNRGR6TDI5MEswaElURUU1Y2tvMVoyZDJOMDQ1VDBaeE5XODROd3A1YlVNMWJGcE5hVzUxYzJwWFMyNUhSRXBSU0ZScFltZEtRMEY2V0dsWFJUQkxla05QTlRkaU1ITmpTemhwZUdWRVRreHRabWwwVDFkNGRuZHBUV2xMQ21GVVpGcHBTMlF2UTBVNFVHRlNhbGhrWVVNcmVWaDNQUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09DQogICAgY2xpZW50LWtleS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJTVTBFZ1VGSkpWa0ZVUlNCTFJWa3RMUzB0TFFwTlNVbEtTMEZKUWtGQlMwTkJaMFZCT1M5dFdVTlVOMDFOVjBkWk5WQlllVkZxTmpoMFpGRkNWM0ZwVEVoQldYcHJMMmN2WlVVclpqVTNjRTlsWkRBeENsZ3lRbmhXYWpCU2FqRXJSV0pJZFdsaEwxSkhURE42TDBFeFVsY3ZZMEpJT0daYWFVYzVXa1pqWjAweWNVWjJWMEZhUWxCaU1rWkxMMFl3VEdsMmJHMEtRMjFoWlRGQlVWaHZWSGRzWWtaUVZsWXliRVpFY1M5SlpXbFhiRzh4VURKb1dWRlBRMDEyYUhaa1VtUnFUWEpHVkVsR1FtTnpWVTVJU2pCNVVtaHBNQXBuU0ZwdE9GWjRTR2x3ZEVNeU16aGllU3RqTkhnMk1YWkphQ3RaWkV0WE5XUm1iblVyUzJSWk5VNUlVRGhXVUZCeGFrNXpaMHhoVXpBMVIxTTFNbEJDQ2xaaGNHWTRXWEZhVkZadVVtVm9VSFZoYjJ4c2RtaGpTamhJZGtzMk1GbE5SQzlST1Vzd1pVOURiMDl2YUhsQmNrdHNSVXRETW01T01Xa3JibEZVYjFJS1VUWlVOM0YyZWpGWk56QlRWMmh2V2xSS01sUkdSMWhCTkhCbVEyY3ZUVTF5TUhvemMydENlR0ZqYmpWWmFtRnJTVVJ4Ym1oNE1IbHdUV050YlZKM1pnbzBRakI2TVd4aWNHWlpUV0V4VDFkaWFrcHVNbTFNY1RFd1NpOHpXbXRxZG5CQmJXeHdTSE5zUm5adE1YVnBaR3QxTjBWaEsxUTNSbkI2Y1dSR1duTkNDbmQyVWtKVGR6SmtRVU1yY0hGbGFVMUVOMkZKYWtnek4xVmhjRVpoTVdScVQwWk1kalJaWkd0eFZHY3pORFZWTkVGcEsxZERSbGhqVDFWVFowOW1RVkVLZEhNd1lrUjFjMmRtU1VFM1dWRkxaazVHY1hKTVZWcGhUWGRQWjBGUmJWZDNXV1pJWnpFMFVsQmxZbmhhYzBoblJHOVFNelJwTVhONVRHbG1ibVJ2U1FwNmVXNXZRVnBSVkUxUVFVSnZhMFpRVUUxQ1VtSnNMM013Y0hOMGVGTTNRV05uT0hKcFFuTkhNM1ZWVTIxRFlYZ3lRV3BaTDBsRFlVTlpTVU5ITkRNMENsQXZPRFptVm5KRVowcDFNVGRFYzJNeWNFUXlRM0l5V21abVRWaFFObmxyUzJoQ2VFNVRibUp4WkZoeFZUSkVXRWxsWW1FNFRXbE9hMHRWUTBGM1JVRUtRVkZMUTBGblFWYzNaa1owUTFjeVFVMHpTV0l5WkVsdk5XWjNNVXBCUm5ORVMwZDNWMkpLZWxGRlZTdE1jaloxWjNJck1qZFJiQ3RhUlVOWGNFNWlNZ294ZGtrM2VHTk1ha1ZLWkdNeFRWbFFNMDFEWldacFZXODNiM1J5TXpSb1ZWaHZLM3BUWVhGclVXd3ZWMEZNTUdGVlRrRTRZbGwwVGpoMVpFVXlOSGRFQ2pCTVpqRkxSblJXTVdSdldUTmFRa0ZIZWsxU2QzcFlUV0Z6VjFKamNXcFNSVTAwUm5OemNFUndUVUZWYVV4M1NuQlZPVGgzT1ZGTkwwOVlVRGcyVWpVS05FcHNlVU51VEdKcEsyNXZURTVXVmpWdE5FZGxlbmxISzBSR2MzUkxlVE50T1RoTGFHRkdlVXcwWTJNM09GUnlOREEwWlV3d09ERlRTMlpQWjJVMWFncENTMk50UkhGdVFrZERkR05TUnpCaE1qVmxURFJrU2tSME1saG5iSEZGTDNZMlZGcDFaRkJFSzJaS1pqQTRla0YyVnpsT2VreDZSRGhKUjBVNGFHTlBDblptUkhkbEwwWlRPRVU0YkZZM1RtRlJTVmwzUWxVeGNTdEZZaXNyWmxnNWJFa3lUVWxoWWxCRVowbFlXVE5pZVhKT1dXb3lUa3c0Y1hkdFRWYzRkMUVLVlN0NE5IY3dSV0ZPY0RWNFZGbFBZVVpRUm1oa2FURTJVVTVYT0hGYVV6ZHNWR1pDVmtKaFpFVlBTMHBPUkRWYVlqRklPSGRtYUhacVdHZHBObVpRUmdwNE5Gb3ZTblZXUkdSUldrbFdRa2RYWm5kNFIyODRkVzlyYmpaUFJERndRVnA0V0hObWNFOUpWRUoxUWxCb1pta3hZbkJoUld4Nk5tNVBiMFJRY1VoaENqWmlhM2hWZFZGbVNHRkpNMHBDZVVkbk1GaHZXV3MwY1V0RmFUWkJUMDAzV0ZGMVpGTXdURUpIVFc1MlYyMWtWQzkyWWxsb1pscHBhemgwZWxkeGNVY0tlSEJ1VTNaQlpERjZVbGwwU0cxSWFYUmhkVTl5Y1RSeWIycHdTRVp4V1N0Nk4weFhZMlZTZDA4NGJHYzBaM2xIWjI1dlRUTnZjSGt3VjJsV2NEWmthQXB5ZUhSaWN6UXZibGRhTVVKdFFqWmxOalI0YjFoVlRsUnVOU3RaWVc1dGFXNVRTWGd3VUN0TWVuTTJObFYxZUROQlVVdERRVkZGUVNzcmVVeHlLMnQzQ25vd1RYZFhjWGxzYzFKV1NsbHNkWGs0Y1U5cFIwOUVlVmRHUkdGMFZrSlpVMjlRV0VsclNrMHhhR2hDYnpKMmRtdHJORlZhTVdkSVpqbEhaVlEzTTBrS2EwNTFXV3RvTVZKVU1tdDZTMXB4Wm5GRllVTkVaV0o2VUROMFVsa3ZRa05YY0ZoQ1ZraHNORWRNUmtkMFRXZGlXVmwyZDBnd2Jrc3lTV05IUmxoYVRRcENXRVZsTVVsWWFsTnBMelZIVFM5TlRVbFhNbTVpV25oQ1NWTm1SSGRJWmpJNFZHNXNjRzVCVTA1Nk4zcE5WVE5uUW04MlVrOUlVekl5WVdvM1RWWmtDbGRKYnpsUlZYQlRPVkIxY1hoU00xZGtaRzA0VjB0a1JXOVhSemN2U21GVFlVOVVaWGh0Ym5WU0t6SnFRVkpvY2xGRGEzaFNjWEYyT1c1MVkwNUNWSFVLY0ZaRGRrYzFZMlpxYzBOSFJHdExLMVI1Y0d0UGNXNTFOVmsxU1VaQk4zaHhVREozWm0xRGJFZFBaR1IxVFVreFMxbExVV2hpU3pONlpWQnpla1pYVVFwTmFHOXRVRmw2WTNodVNXRldVVXREUVZGRlFTc3ZlWGhESzJaNWJFRnBTVkZtUVhSRWRXcHBVSGhQU0hZeWNrZFROMVZZWldOTk1tWllOQzk1VTFRckNpc3ZlRWx5ZVRRMFVqQkdXbkYzVVRWemFTODJialkyUVV3emVqbGlSWE1yVEdKV2NVcENiazlQYzFZd056WlBlbXBtTWpaUGQwbFpZalUzUkVaTmJrVUtSVVJPWVZGTVYxTnVkSE40VGtKcGNFZHZTVk4wTURCelNIQnZPQ3RCYWxkTlRsQkVWSHBrU0dsaVkxaE5OblZUWTBkM01ucEVUekYzUTBocVZYVlZTQXBzU1dWRFFUVlpaRU5CWlM4MVdHbG1WV3hKSzNWSlUxTk5WVEExT1VwSU1WSmFaSEUwUlhGdllXeHBPVTR2VmtOMGRtNU9kMXA0UjBkTWVXWkVlakpEQ25sclJETkNObGh5YUdWRlpsaDRabkZoTVVRek0zZHVSRTB4T0ZOUVdEazRXa1pHYUdOdFIzWmlZVkZGWjJWeGVVNUtPR2Q1UTBjM1dXTkliR1p2YkM4S1RFUTBVbmhqTldsMGJ6aEJLM0I0YjJ4VlJIZE1VazFTUldsdmRYSTFkM0UwUWpKSmN6VlhUa1ZSUzBOQlVVRlNlbFJLUm5WUE1uQkNOamx2UTA5Rlp3cGtWV1ZrVDNGMVdHUTNZV2h0VjNWdGFpOW5WV0prZGk5VUwyVnZlRkpUVnpSR2JuSkRWbkZDWkZORU9TdElkRE5NWTBoS1JYSnJWV1V4THpWdGVtRXJDbkpOYkdaMlJIaG9PRXhIU2prdlRHbFliakYxTWxoQ2JUVkZVVzlEZG14UmFsWTFXWE5tWXpGWGJWVmhXVTlYUkdwWE9FSnVlakZhSzFKa1ltNTVXbW9LWmt0YVYyVlpRMDVSVkZkYVUxZFpUa1Z4TkVkeGJsRXJTRVpxWkVSSWNFazJPSGxxVDB0Q2JWaG1VVmRJTDNJNVdTOUNZbUk0Y21Jd1pFUnZVbms0TndwbWJtdG1kWEU0U0ROME0zWlRZM0ZSZFUwMVJ6SkJSRFpvYjIxNllscE1XRFZHVUhKYVQxWllVVVpJY1VVeUsyaDBSRkpwWm1OUmNsUkdkRVJWVG1RM0NrSXJSM2hMYTJjeVdXVkdOVkEzTjFFeU9DOHJSWFI0UTNVNFNqTXJOalZQTlhwS05VNXpaalEyWlM4MlkzQnRTVmt2TWpod2NVMXpNWGx2ZVcxVWVWVUthbFZYVGtGdlNVSkJVVU5pY1Rjd1dXeE9PVFJqYkdwNlJ6RlNTM1pNV21keU1HdFRhVkF3WkRocE9HaHBkV0pVTW1wWEwzQnljR0p2TjNsdVpFazVVZ292WkRWUFZqRnljR0ZPYVZVME0waFFXa3BGVHpSUFJERjZabWhZWlhoWE4yMTRZV3h2VDFWb1IwSnNMM05OYVRFeFJXWkRVazg1TlRkeEsxbEJSbEZ1Q2tSV1V6RlZXRXhQY2tsTGVHVk9lVVIyTVdSb1FqbDVRelUxTDIxQ1ZXMU9iVEl5WVM5NWFVWnBWMVJGTDBWRlVrSkNOWGx5U1dwc1Uyd3lXWEExYTJnS2VEa3ZWaTlLUnpSbmNGTTJNbnBQVW1ZMWMwcExNRFY1UVhCM1JrZHFiek5GVFVVNGJUWnFkV0o0Tm1OMVJsWmFiazVXUzNwbU5VcDNjRFphZFM5bWJncHBiVGhsUTFOR1NqQlJhVUZaYjBOVU9FOTZUWG93UW1sdVVpOTBWVTF1VjIxNFozQjRibkl6U2xWT1ZWQXZjVW8xZDFwSVEwNTRiVEJoVjJKS1QyYzBDbnBrYlZZclUwSnROMGR2ZWk5dE5YbFpWbkpqU2tWalkyc3dTa3hhTVRGNFFXOUpRa0ZJYUZvMVRtaE9kbWxzWkVOcVJXTmxWR2RMWW1odFRqWnNORkFLVmxSVlFtcFpia1p5UldOb1lsUkdOa2xsWVRjMk1Ib3pTblJaVVRWV09WTjJRM0YwTkdWamMwbzNURWxVY2pjd01EZG9lR1l6YlU1TFMyczJlSGRpY1FwWFNGWkNVU3QxZEZWdVZEQXhWVWR1SzAxMGJucG1aVzlzTm5nMFpEWkVNWFZPVVhaTlRsSkRTamR6WW01cFZFNUhUV3d3UVUxRWFtc3hkU3N3VEVoM0Nrc3pjMEZSUkhjdmQySTFUemhYVG5wM1VIUlRVMEUxWlhOWVpXRm5TREUzVUdwMGFFZDNVVEphV0hkeGEzRXlZMEZEWVcxM1VHRktXSGt4UzBrNE1VWUtjR3RMWTBONmJtWXdhMjVQTDJSV01FNURiMjVVYVd4V1dGUlhZalY0YTNVd1NqUndZVXc1TlhKTVRXZDZWalZOY1ZKNmJuWXpUSFZxTmpjek0wOVVNd3BDYTNSWGNWRmFWM1pMYWtwMFZXa3pkeXRQUzNkSmFtVTBaREJ5ZWtOQ01YaG5XR2xDVXpKMVprOUJlSFo0TWxoblJGcEVSbFppTm5FNWF6MEtMUzB0TFMxRlRrUWdVbE5CSUZCU1NWWkJWRVVnUzBWWkxTMHRMUzBLDQogICAgdG9rZW46IDZrcXB3emtmNHU3cGhyZ28zY2locWVzNHcwZDVza3Izdm5teDhxdmJlNDNnaDgzbTlyaWdvMDZybWVkamN6eWg2cjBqNTVpNmc1bzN0cjFvcXoydW9pcW9zc2hhaXZ4dzB3aTdvc3Q4bGg3dGJ2Yjg1ZDZxcmpxNjRxZ2FtZnUwDQo=
          kubectl-version: v1.24.2
      
      # Expands the manifest YAML file (i.e. replaces placeholders in the YAML file with environment variable values)
      # and deploys the microservice to the Azure Kubernetes Service (AKS) cluster.
      - name: Deploy
        run: envsubst < kubernetes/deploy.yaml | kubectl apply -f -